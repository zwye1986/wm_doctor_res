<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.pinde.sci.dao.hbres.HbresGraduationApplyExtMapper">
    <resultMap id="chargeQueryMap" type="java.util.HashMap" >
        <result column="DOCTOR_FLOW" property="doctorFlow" jdbcType="VARCHAR" />
        <result column="RECRUIT_FLOW" property="recruitFlow" jdbcType="VARCHAR" />
        <result column="ORG_FLOW" property="orgFlow" jdbcType="VARCHAR" />
        <result column="ORG_NAME" property="orgName" jdbcType="VARCHAR" />
        <result column="USER_NAME" property="userName" jdbcType="VARCHAR" />
        <result column="EDUCATION_ID" property="educationId" jdbcType="VARCHAR" />
        <result column="EDUCATION_NAME" property="educationName" jdbcType="VARCHAR" />
        <result column="TRAINING_SPE_ID" property="speId" jdbcType="VARCHAR" />
        <result column="TRAINING_SPE_NAME" property="speName" jdbcType="VARCHAR" />
        <result column="TRAINING_SPE_ID" property="changeSpeId" jdbcType="VARCHAR" />
        <result column="TRAINING_SPE_NAME" property="changeSpeName" jdbcType="VARCHAR" />
        <result column="SESSION_NUMBER" property="sessionNumber" jdbcType="VARCHAR" />
        <result column="TRAINING_YEARS" property="trainYear" jdbcType="VARCHAR" />
        <result column="PRACTICING_SCOPE_NAME" property="practicingScopeName" jdbcType="VARCHAR" />
        <result column="MATERIAL_ID" property="qualificationMaterialId" jdbcType="VARCHAR" />
        <result column="MATERIAL_NAME" property="qualificationMaterialName" jdbcType="VARCHAR" />
        <result column="CERTIFICATE_URI" property="certificateUri" jdbcType="VARCHAR" />
        <result column="CERTIFICATE_NO" property="certificateNo" jdbcType="VARCHAR" />
        <result column="QUALIFICATION_MATERIAL_URI" property="qualificationMaterialUri" jdbcType="VARCHAR" />
        <result column="QUALIFICATION_MATERIAL_CODE" property="qualificationMaterialCode" jdbcType="VARCHAR" />
        <result column="SPECIAL_CERTIFICATION_URI" property="specialCertificationUri" jdbcType="VARCHAR" />
        <result column="IS_PASS" property="isPass" jdbcType="VARCHAR" />
        <result column="SCORE_FLOW" property="scoreFlow" jdbcType="VARCHAR" />
        <result column="AVG_COMPLETE" property="avgComplete" jdbcType="VARCHAR" />
        <result column="AVG_AUDIT" property="avgAudit" jdbcType="VARCHAR" />
        <result column="AUDIT_STATUS_ID" jdbcType="VARCHAR" property="auditStatusId" />
        <result column="AUDIT_STATUS_NAME" jdbcType="VARCHAR" property="auditStatusName" />
        <result column="LOCAL_AUDIT_STATUS_ID" jdbcType="VARCHAR" property="localAuditStatusId" />
        <result column="LOCAL_AUDIT_STATUS_NAME" jdbcType="VARCHAR" property="localAuditStatusName" />
        <result column="LOCAL_REASON" jdbcType="VARCHAR" property="localReason" />
        <result column="CITY_AUDIT_STATUS_ID" jdbcType="VARCHAR" property="cityAuditStatusId" />
        <result column="CITY_AUDIT_STATUS_NAME" jdbcType="VARCHAR" property="cityAuditStatusName" />
        <result column="CITY_REASON" jdbcType="VARCHAR" property="cityReason" />
        <result column="GLOBAL_AUDIT_STATUS_ID" jdbcType="VARCHAR" property="globalAuditStatusId" />
        <result column="GLOBAL_AUDIT_STATUS_NAME" jdbcType="VARCHAR" property="globalAuditStatusName" />
        <result column="GLOBAL_REASON" jdbcType="VARCHAR" property="globalReason" />
        <result column="AUDIT_REASON" jdbcType="VARCHAR" property="auditReason" />
        <result column="START_DATE" jdbcType="VARCHAR" property="startDate" />
        <result column="END_DATE" jdbcType="VARCHAR" property="endDate" />
        <result column="APPLY_FLOW" jdbcType="VARCHAR" property="applyFlow" />
        <result column="APPLY_YEAR" jdbcType="VARCHAR" property="applyYear" />
    </resultMap>

    <select id="chargeQueryApplyList" resultMap="chargeQueryMap">
        SELECT RD.DOCTOR_FLOW,
        RD.DOCTOR_FLOW recruit_flow,
        RD.ORG_NAME,
        RD.ORG_FLOW,
        SU.USER_NAME,
        SU.EDUCATION_ID,
        SU.EDUCATION_NAME,
        RD.TRAINING_SPE_ID,
        RD.TRAINING_SPE_NAME,
        RD.SESSION_NUMBER,
        RD.TRAINING_YEARS,
        case when RD.IN_HOS_DATE IS NOT NULL
              then RD.IN_HOS_DATE
        else RD.SESSION_NUMBER||'-09-01'
        end START_DATE,
        case when RD.IN_HOS_DATE IS NOT NULL
        then
            CASE
            WHEN RD.TRAINING_YEARS='1' THEN to_char(add_months(to_date(RD.IN_HOS_DATE, 'yyyy-mm-dd'),12)-1, 'yyyy-mm-dd')
            WHEN RD.TRAINING_YEARS='2' THEN to_char(add_months(to_date(RD.IN_HOS_DATE, 'yyyy-mm-dd'),12*2)-1, 'yyyy-mm-dd')
            WHEN RD.TRAINING_YEARS='3' THEN to_char(add_months(to_date(RD.IN_HOS_DATE, 'yyyy-mm-dd'),12*3)-1, 'yyyy-mm-dd')
            ELSE ''
            END
        else RD.GRADUATION_YEAR||'-08-31'
        end END_DATE,
        JGA.GRADUATION_SCOPE_NAME PRACTICING_SCOPE_NAME,
        JGA.GRADUATION_MATERIAL_ID MATERIAL_ID,
        JGA.GRADUATION_MATERIAL_NAME MATERIAL_NAME,
        JGA.CERTIFICATE_URI,
        JGA.CERTIFICATE_NO,
        JGA.GRADUATION_MATERIAL_URI QUALIFICATION_MATERIAL_URI,
        JGA.GRADUATION_MATERIAL_CODE QUALIFICATION_MATERIAL_CODE,
        JGA.SPECIAL_CERTIFICATION_URI,
        JGA.APPLY_FLOW,
        JGA.AUDIT_STATUS_ID,
        JGA.AUDIT_STATUS_NAME,
        JGA.LOCAL_AUDIT_STATUS_ID,
        JGA.LOCAL_AUDIT_STATUS_NAME,
        JGA.LOCAL_REASON,
        JGA.CITY_AUDIT_STATUS_ID,
        JGA.CITY_AUDIT_STATUS_NAME,
        JGA.CITY_REASON,
        JGA.GLOBAL_AUDIT_STATUS_ID,
        JGA.GLOBAL_AUDIT_STATUS_NAME,
        JGA.GLOBAL_REASON,
        CASE WHEN JGA.GLOBAL_AUDIT_STATUS_ID IS NOT NULL THEN JGA.GLOBAL_REASON
        WHEN JGA.CITY_AUDIT_STATUS_ID IS NOT NULL THEN JGA.CITY_REASON
        WHEN JGA.LOCAL_AUDIT_STATUS_ID IS NOT NULL THEN JGA.LOCAL_REASON
        ELSE '' END AUDIT_REASON,
        JGA.APPLY_YEAR,
        NVL(JGA.AVG_COMPLETE,0) AVG_COMPLETE,
        NVL(JGA.AVG_AUDIT,0) AVG_AUDIT,
        NVL(JGA.AVG_IN_COMPLETE,0)     AVG_IN_COMPLETE,
        NVL(JGA.AVG_OUT_COMPLETE,0)            AVG_OUT_COMPLETE
        FROM JSRES_GRADUATION_APPLY JGA
        LEFT JOIN RES_DOCTOR RD
        ON JGA.RECRUIT_FLOW = RD.DOCTOR_FLOW
        INNER JOIN SYS_USER SU
        ON RD.DOCTOR_FLOW = SU.USER_FLOW
        WHERE RD.RECORD_STATUS = 'Y'
        AND JGA.RECORD_STATUS = 'Y'
        AND SU.RECORD_STATUS = 'Y'
        and RD.org_flow in(
        SELECT ORG_FLOW
        FROM PDSCI.SYS_ORG
        WHERE PDSCI.SYS_ORG.RECORD_STATUS='Y'
        <if test="org!=null">
            <if test="org.orgProvId!=null and org.orgProvId!=''">
                AND ORG_PROV_ID = #{org.orgProvId}
            </if>
            <if test="org.orgCityId!=null and org.orgCityId!=''">
                AND ORG_CITY_ID = #{org.orgCityId}
            </if>
            <if test="org.orgLevelId!=null and org.orgLevelId!=''">
                AND ORG_LEVEL_ID = #{org.orgLevelId}
            </if>
            <if test="org.orgTypeId!=null and org.orgTypeId!=''">
                AND ORG_TYPE_ID = #{org.orgTypeId}
            </if>
        </if>
        )
        <if test="orgFlow!=null and orgFlow!=''">
            AND RD.org_flow = #{orgFlow}
        </if>
        <if test="orgFlowList!=null and orgFlowList.size>0">
            and RD.org_flow in
            <foreach collection="orgFlowList" open="(" separator="," close=")" item="item">#{item}</foreach>
        </if>
        <if test="docTypeList!=null and docTypeList.size>0">
            and RD.DOCTOR_TYPE_ID in
            <foreach collection="docTypeList" open="(" separator="," close=")" item="item">#{item}</foreach>
        </if>
        <if test="speIds!=null and speIds.size>0">
            and RD.TRAINING_SPE_ID in
            <foreach collection="speIds" open="(" separator="," close=")" item="item">#{item}</foreach>
        </if>
        <if test="trainingSpeId!=null and trainingSpeId!=''">
            and RD.TRAINING_SPE_ID = #{trainingSpeId}
        </if>
        <if test="sessionNumbers!=null and sessionNumbers.size>0">
            and RD.SESSION_NUMBER in
            <foreach collection="sessionNumbers" open="(" separator="," close=")" item="item">#{item}</foreach>
        </if>
        <if test="sessionNumber!=null and sessionNumber!=''">
            and RD.SESSION_NUMBER = #{sessionNumber}
        </if>
        <if test="graduationYear!=null and graduationYear!=''">
            and RD.GRADUATION_YEAR = #{graduationYear}
        </if>
        <if test="qualificationMaterialId!=null and qualificationMaterialId!=''">
            and JGA.GRADUATION_MATERIAL_ID = #{qualificationMaterialId}
        </if>
        <if test="passFlag!=null and passFlag!=''">
            and SCORE.SKILL_SCORE = #{passFlag}
        </if>
        <if test="completeBi!=null and completeBi!=''">
            and to_number(NVL(JGA.AVG_COMPLETE,0))   <![CDATA[<=]]> #{completeBi}
        </if>
        <if test="auditBi!=null and auditBi!=''">
            and to_number(NVL(JGA.AVG_AUDIT,0))  <![CDATA[<=]]> #{auditBi}
        </if>
        <if test="userName!=null and userName!=''">
            <bind name="userName" value="'%'+userName+'%'"/>
            and Su.USER_NAME like #{userName}
        </if>
        <if test="idNo!=null and idNo!=''">
            <bind name="idNo" value="'%'+idNo+'%'"/>
            and Su.ID_NO like #{idNo}
        </if>
        <if test="auditStatusId !='' and  auditStatusId!=null">
            AND JGA.AUDIT_STATUS_ID =#{auditStatusId}
        </if>
        <if test="applyYear!=null and applyYear!=''">
        AND JGA.APPLY_YEAR = #{applyYear}
        </if>
        order by
        RD.TRAINING_SPE_ID,
        RD.SESSION_NUMBER,
        NLSSORT(su.USER_NAME,'NLS_SORT = SCHINESE_PINYIN_M')
    </select>

    <resultMap id="chargeQueryExportMap" type="java.util.HashMap" >
        <result column="DOCTOR_FLOW" property="doctorFlow" jdbcType="VARCHAR" />
        <result column="RECRUIT_FLOW" property="recruitFlow" jdbcType="VARCHAR" />
        <result column="ORG_FLOW" property="orgFlow" jdbcType="VARCHAR" />
        <result column="ORG_NAME" property="orgName" jdbcType="VARCHAR" />
        <result column="COUNTRY_ORG_FLOW" property="countryOrgFlow" jdbcType="VARCHAR" />
        <result column="COUNTRY_ORG_NAME" property="countryOrgName" jdbcType="VARCHAR" />
        <result column="USER_NAME" property="userName" jdbcType="VARCHAR" />
        <result column="ID_NO" property="idNo" jdbcType="VARCHAR" />
        <result column="EDUCATION_ID" property="educationId" jdbcType="VARCHAR" />
        <result column="EDUCATION_NAME" property="educationName" jdbcType="VARCHAR" />
        <result column="TRAINING_SPE_ID" property="speId" jdbcType="VARCHAR" />
        <result column="TRAINING_SPE_NAME" property="speName" jdbcType="VARCHAR" />
        <result column="TRAINING_SPE_ID" property="changeSpeId" jdbcType="VARCHAR" />
        <result column="TRAINING_SPE_NAME" property="changeSpeName" jdbcType="VARCHAR" />
        <result column="SESSION_NUMBER" property="sessionNumber" jdbcType="VARCHAR" />
        <result column="TRAINING_YEARS" property="trainYear" jdbcType="VARCHAR" />
        <result column="TRAIN_YEAR_NAME" property="trainYearName" jdbcType="VARCHAR" />
        <result column="PRACTICING_SCOPE_NAME" property="practicingScopeName" jdbcType="VARCHAR" />
        <result column="MATERIAL_ID" property="qualificationMaterialId" jdbcType="VARCHAR" />
        <result column="MATERIAL_NAME" property="qualificationMaterialName" jdbcType="VARCHAR" />
        <result column="MATERIAL_TIME" property="qualificationMaterialTime" jdbcType="VARCHAR" />
        <result column="CERTIFICATE_URI" property="certificateUri" jdbcType="VARCHAR" />
        <result column="CERTIFICATE_NO" property="certificateNo" jdbcType="VARCHAR" />
        <result column="QUALIFICATION_MATERIAL_URI" property="qualificationMaterialUri" jdbcType="VARCHAR" />
        <result column="QUALIFICATION_MATERIAL_CODE" property="qualificationMaterialCode" jdbcType="VARCHAR" />
        <result column="SPECIAL_CERTIFICATION_URI" property="specialCertificationUri" jdbcType="VARCHAR" />
        <result column="IS_PASS" property="isPass" jdbcType="VARCHAR" />
        <result column="SCORE_FLOW" property="scoreFlow" jdbcType="VARCHAR" />
        <result column="AVG_COMPLETE" property="avgComplete" jdbcType="VARCHAR" />
        <result column="AVG_IN_COMPLETE" property="avgInComplete" jdbcType="VARCHAR" />
        <result column="AVG_OUT_COMPLETE" property="avgOutComplete" jdbcType="VARCHAR" />
        <result column="AVG_AUDIT" property="avgAudit" jdbcType="VARCHAR" />
        <result column="AUDIT_STATUS_ID" jdbcType="VARCHAR" property="auditStatusId" />
        <result column="AUDIT_STATUS_NAME" jdbcType="VARCHAR" property="auditStatusName" />
        <result column="LOCAL_AUDIT_STATUS_ID" jdbcType="VARCHAR" property="localAuditStatusId" />
        <result column="LOCAL_AUDIT_STATUS_NAME" jdbcType="VARCHAR" property="localAuditStatusName" />
        <result column="LOCAL_REASON" jdbcType="VARCHAR" property="localReason" />
        <result column="CITY_AUDIT_STATUS_ID" jdbcType="VARCHAR" property="cityAuditStatusId" />
        <result column="CITY_AUDIT_STATUS_NAME" jdbcType="VARCHAR" property="cityAuditStatusName" />
        <result column="CITY_REASON" jdbcType="VARCHAR" property="cityReason" />
        <result column="GLOBAL_AUDIT_STATUS_ID" jdbcType="VARCHAR" property="globalAuditStatusId" />
        <result column="GLOBAL_AUDIT_STATUS_NAME" jdbcType="VARCHAR" property="globalAuditStatusName" />
        <result column="GLOBAL_REASON" jdbcType="VARCHAR" property="globalReason" />
        <result column="AUDIT_REASON" jdbcType="VARCHAR" property="auditReason" />
        <result column="START_DATE" jdbcType="VARCHAR" property="startDate" />
        <result column="END_DATE" jdbcType="VARCHAR" property="endDate" />
        <result column="APPLY_FLOW" jdbcType="VARCHAR" property="applyFlow" />
        <result column="APPLY_YEAR" jdbcType="VARCHAR" property="applyYear" />
        <result column="REGISTE_MANUA" jdbcType="VARCHAR" property="registeManua" />
        <result column="SEX_NAME" jdbcType="VARCHAR" property="sexName" />
        <result column="WORK_ORG_NAME" jdbcType="VARCHAR" property="workOrgName" />
        <result column="ORG_CITY_NAME" jdbcType="VARCHAR" property="orgCityName" />
        <result column="ALL_NUM" jdbcType="VARCHAR" property="allNum" />
        <result column="UP_NUM" jdbcType="VARCHAR" property="upNum" />
        <result column="ALL_SCH_MONTH" jdbcType="VARCHAR" property="allSchMonth" />
    </resultMap>

    <select id="chargeQueryListForExport" resultMap="chargeQueryExportMap">
        SELECT RD.DOCTOR_FLOW,
            RD.ORG_NAME,
            RD.ORG_FLOW,
            rjo.ORG_FLOW country_Org_flow,
            rjo.ORG_NAME country_Org_Name,
            SO.ORG_CITY_NAME,
            SU.USER_NAME,
            SU.ID_NO,
            SU.SEX_NAME,
            SU.EDUCATION_ID,
            SU.EDUCATION_NAME,
            RD.TRAINING_SPE_ID,
            RD.TRAINING_SPE_NAME,
            RD.SESSION_NUMBER,
            RD.TRAINING_YEARS,
            case when RD.IN_HOS_DATE IS NOT NULL
            then RD.IN_HOS_DATE
            else RD.SESSION_NUMBER||'-09-01'
            end START_DATE,
            case when RD.IN_HOS_DATE IS NOT NULL
            then
            CASE
            WHEN RD.TRAINING_YEARS='1' THEN to_char(add_months(to_date(RD.IN_HOS_DATE, 'yyyy-mm-dd'),12)-1, 'yyyy-mm-dd')
            WHEN RD.TRAINING_YEARS='2' THEN to_char(add_months(to_date(RD.IN_HOS_DATE, 'yyyy-mm-dd'),12*2)-1, 'yyyy-mm-dd')
            WHEN RD.TRAINING_YEARS='3' THEN to_char(add_months(to_date(RD.IN_HOS_DATE, 'yyyy-mm-dd'),12*3)-1, 'yyyy-mm-dd')
            ELSE ''
            END
            else RD.GRADUATION_YEAR||'-08-31'
            end END_DATE,
            CASE
            WHEN RD.TRAINING_YEARS='1' THEN '一年'
            WHEN RD.TRAINING_YEARS='2' THEN  '两年'
            WHEN RD.TRAINING_YEARS='3' THEN   '三年'
            ELSE ''
            END TRAIN_YEAR_NAME,
            RD.WORK_ORG_NAME,
            JGA.GRADUATION_SCOPE_NAME PRACTICING_SCOPE_NAME,
            JGA.GRADUATION_MATERIAL_ID MATERIAL_ID,
            JGA.GRADUATION_MATERIAL_NAME MATERIAL_NAME,
            JGA.GRADUATION_MATERIAL_TIME MATERIAL_TIME,
            JGA.CERTIFICATE_URI,
            JGA.CERTIFICATE_NO,
            JGA.GRADUATION_MATERIAL_URI QUALIFICATION_MATERIAL_URI,
            JGA.GRADUATION_MATERIAL_CODE QUALIFICATION_MATERIAL_CODE,
            JGA.SPECIAL_CERTIFICATION_URI,
            CASE
            WHEN JGA.REGISTE_MANUA = '1' THEN
            '已完成'
            WHEN JGA.REGISTE_MANUA = '0' THEN
            '未完成'
            ELSE
            ''
            END REGISTE_MANUA,
            JGA.APPLY_FLOW,
            JGA.AUDIT_STATUS_ID,
            JGA.AUDIT_STATUS_NAME,
            JGA.LOCAL_AUDIT_STATUS_ID,
            JGA.LOCAL_AUDIT_STATUS_NAME,
            JGA.LOCAL_REASON,
            JGA.CITY_AUDIT_STATUS_ID,
            JGA.CITY_AUDIT_STATUS_NAME,
            JGA.CITY_REASON,
            JGA.GLOBAL_AUDIT_STATUS_ID,
            JGA.GLOBAL_AUDIT_STATUS_NAME,
            JGA.GLOBAL_REASON,
        CASE WHEN JGA.GLOBAL_AUDIT_STATUS_ID IS NOT NULL THEN JGA.GLOBAL_REASON
        WHEN JGA.CITY_AUDIT_STATUS_ID IS NOT NULL THEN JGA.CITY_REASON
        WHEN JGA.LOCAL_AUDIT_STATUS_ID IS NOT NULL THEN JGA.LOCAL_REASON
        ELSE '' END AUDIT_REASON,
        JGA.APPLY_YEAR,
        NVL(JGA.AVG_COMPLETE,0) AVG_COMPLETE,
        NVL(JGA.AVG_AUDIT,0) AVG_AUDIT,
        NVL(JGA.AVG_IN_COMPLETE,0)     AVG_IN_COMPLETE,
        NVL(JGA.AVG_OUT_COMPLETE,0)            AVG_OUT_COMPLETE,
        to_char(nvl((
            select sum(sch_month) from sch_arrange_result sar where sar.record_status='Y'
            and sar.doctor_flow=rd.doctor_flow and
            exists(
             select 1 from sch_rotation_dept sr where sr.record_status='Y'
             and sar.standard_group_flow=sr.group_flow and sar.standard_dept_id=sr.standard_dept_id
             and sr.org_flow is null and sr.rotation_flow=JGA.rotation_flow
            )
        ),0)) ALL_SCH_MONTH,
        to_char(nvl((
        select count(1) from sch_rotation_dept sr where sr.record_status='Y'
        and sr.org_flow is null and sr.rotation_flow=JGA.rotation_flow
        and exists(select 1 from sch_arrange_result sar where sar.record_status='Y'
        and sar.standard_group_flow=sr.group_flow and sar.standard_dept_id=sr.standard_dept_id
        and sar.doctor_flow=rd.doctor_flow)
        ),0)) ALL_NUM
        FROM JSRES_GRADUATION_APPLY JGA
        LEFT JOIN RES_DOCTOR RD
        ON JGA.RECRUIT_FLOW = RD.DOCTOR_FLOW
        INNER JOIN SYS_USER SU
        ON RD.DOCTOR_FLOW = SU.USER_FLOW
        LEFT JOIN SYS_ORG SO
        ON SO.ORG_FLOW=RD.ORG_FLOW
        left join res_joint_org rjo
        on rjo.joint_org_flow = RD.org_flow and rjo.record_status = 'Y'
        WHERE RD.RECORD_STATUS = 'Y'
        AND JGA.RECORD_STATUS = 'Y'
        AND SU.RECORD_STATUS = 'Y'
        AND SO.RECORD_STATUS = 'Y'
        and RD.org_flow in(
            SELECT ORG_FLOW
            FROM PDSCI.SYS_ORG
            WHERE PDSCI.SYS_ORG.RECORD_STATUS='Y'
            <if test="org!=null">
                    <if test="org.orgProvId!=null and org.orgProvId!=''">AND ORG_PROV_ID = #{org.orgProvId}
                    </if>
                    <if test="org.orgCityId!=null and org.orgCityId!=''">
                        AND ORG_CITY_ID = #{org.orgCityId}
                    </if>
                    <if test="org.orgLevelId!=null and org.orgLevelId!=''">
                        AND ORG_LEVEL_ID = #{org.orgLevelId}
                    </if>
                    <if test="org.orgTypeId!=null and org.orgTypeId!=''">
                        AND ORG_TYPE_ID = #{org.orgTypeId}
                    </if>
                </if>
        )
        <if test="orgFlow!=null and orgFlow!=''">
            AND RD.org_flow = #{orgFlow}
        </if>
        <if test="docTypeList!=null and docTypeList.size>0">
            and RD.DOCTOR_TYPE_ID in
            <foreach collection="docTypeList" open="(" separator="," close=")" item="item">#{item}</foreach>
        </if>
        <if test="orgFlowList!=null and orgFlowList.size>0">
            and RD.org_flow in
            <foreach collection="orgFlowList" open="(" separator="," close=")" item="item">#{item}</foreach>
        </if>
        <if test="trainingSpeId!=null and trainingSpeId!=''">
            and RD.TRAINING_SPE_ID = #{trainingSpeId}
        </if>
        <if test="sessionNumber!=null and sessionNumber!=''">
            and rd.SESSION_NUMBER = #{sessionNumber}
        </if>
        <if test="graduationYear!=null and graduationYear!=''">
            and rd.GRADUATION_YEAR = #{graduationYear}
        </if>
        <if test="qualificationMaterialId!=null and qualificationMaterialId!=''">
            and JGA.GRADUATION_MATERIAL_ID = #{qualificationMaterialId}
        </if>
        <if test="passFlag!=null and passFlag!=''">
            and SCORE.SKILL_SCORE = #{passFlag}
        </if>
        <if test="completeBi!=null and completeBi!=''">
            and to_number(NVL(JGA.AVG_COMPLETE,0))   <![CDATA[<=]]> #{completeBi}
        </if>
        <if test="auditBi!=null and auditBi!=''">
            and to_number(NVL(JGA.AVG_AUDIT,0))  <![CDATA[<=]]> #{auditBi}
        </if>
        <if test="userName!=null and userName!=''">
            <bind name="userName" value="'%'+userName+'%'"/>
            and Su.USER_NAME like #{userName}
        </if>
        <if test="idNo!=null and idNo!=''">
            <bind name="idNo" value="'%'+idNo+'%'"/>
            and Su.ID_NO like #{idNo}
        </if>
        <if test="auditStatusId !='' and  auditStatusId!=null">
             AND JGA.AUDIT_STATUS_ID =#{auditStatusId}
        </if>
        <if test="applyYear!=null and applyYear!=''">
            AND JGA.APPLY_YEAR = #{applyYear}
        </if>
        order by
            RD.TRAINING_SPE_ID,
            RD.SESSION_NUMBER,
            NLSSORT(su.USER_NAME,'NLS_SORT = SCHINESE_PINYIN_M')
    </select>
</mapper>